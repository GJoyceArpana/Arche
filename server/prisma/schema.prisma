// Prisma Schema File
// Docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum skillLevel {
  BEGINNER
  INTERMEDIATE
  ADVANCED
}

enum prefferedLanguage {
  ENGLISH
  HINDI
}

model User {
  id            String            @id @default(cuid())
  email         String            @unique
  name          String
  password_hash String
  userJourneys  learningJourney[]
  createdAt     DateTime          @default(now())
  updatedAt     DateTime          @updatedAt
}

model learningJourney {
  id                    String                @id @default(cuid())
  topicName             String
  userId                String
  user                  User                  @relation(fields: [userId], references: [id])
  subTopics             subTopic[]
  learningPreferences  learningPreference[]
  createdAt             DateTime              @default(now())
  updatedAt             DateTime              @updatedAt

  @@index([userId])
}

model learningPreference {
  id                   String                @id @default(cuid())
  mainTopicName        String
  skillLevel           skillLevel
  language             prefferedLanguage
  hoursPerDay          Int
  monthsToComplete     Int

  learningJourney      learningJourney       @relation(fields: [learningJourneyId], references: [id])
  learningJourneyId    String

  createdAt            DateTime              @default(now())
  updatedAt            DateTime              @updatedAt

  @@index([learningJourneyId])
}

model subTopic {
  id                   String                @id @default(cuid())
  description          String

  learningJourney      learningJourney       @relation(fields: [learningJourneyId], references: [id])
  learningJourneyId    String

  videoResources       videoResource[]

  isCompleted          Boolean               @default(false)

  createdAt            DateTime              @default(now())
  updatedAt            DateTime              @updatedAt
}

model videoResource {
  id                   String                @id @default(cuid())
  title                String
  url                  String
  duration             Int

  subTopic             subTopic              @relation(fields: [subTopicId], references: [id])
  subTopicId           String

  createdAt            DateTime              @default(now())
  updatedAt            DateTime              @updatedAt

  @@index([subTopicId])
}
